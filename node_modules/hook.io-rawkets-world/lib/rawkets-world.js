var Hook = require("hook.io").Hook,
	util = require("util"),
	Connection = require("./Connection").Connection;

var RawketsWorld = exports.RawketsWorld = function(options){
	Hook.call(this, options);
	var self = this;

	self.on("hook::ready", function() {
		// Grab world values from config
		self.worldHeight = self.config.get("world:height");
		self.worldWidth = self.config.get("world:width");
		self.maxAiPlayers = self.config.get("world:maxAiPlayers");
		self.messageTypes = self.config.get("world:messageTypes");
		self.typeIndexes = self.config.get("world:typeIndexes");

		// Prepare other variables
		self.connection = new Connection({port: 8080, debug: true});

		setInterval(function() {
			var playerId = 123;
			self.connection.broadcastEach(Date.now(), function(client) {
				if (123 === playerId) {
					return self.connection.messagePriorities.PASS;
				}

				return self.connection.messagePriorities.HIGH;
			});
			self.connection.flushQueues();
		}, 100);
	});
};

// RawketsWorld inherits from Hook
util.inherits(RawketsWorld, Hook);